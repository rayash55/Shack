<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ash Shack Booking</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#1b4d6b">

  <link rel="manifest" href="manifest.json">
  <link rel="icon" sizes="192x192" href="icons/icon-192.png">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: "Poppins", -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
      color: #102024;
    }

    body {
      /* Full-screen river photo */
      background: url("river-bg.jpg") no-repeat center center fixed;
      background-size: cover;
      display: flex;
      justify-content: center;
      align-items: stretch;
    }

    .app {
      width: 100%;
      max-width: 420px;
      padding: 14px 10px 18px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      position: relative;
    }

    /* Frosted glass card */
    .card {
      background: rgba(255,255,255,0.22);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.4);
      box-shadow: 0 14px 35px rgba(0,0,0,0.25);
      padding: 10px 12px;
    }

    .card-compact {
      padding: 8px 10px;
    }

    .card-header {
      text-align: center;
    }

    h1 {
      margin: 0;
      font-size: 1.35rem;
      font-weight: 600;
    }

    .subtitle {
      margin-top: 4px;
      font-size: 0.8rem;
      color: #103445;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.9rem;
    }

    .user-label {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .colour-preview {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      border: 1px solid #555;
    }

    /* … menu icon */
    #menuBtn {
      font-size: 22px;
      background: rgba(255,255,255,0.55);
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.12);
      cursor: pointer;
      padding: 4px 10px 6px;
      line-height: 1;
      box-shadow: 0 4px 10px rgba(0,0,0,0.18);
    }

    #menuBtn:active {
      transform: scale(0.96);
    }

    /* Slide-out admin panel */
    #adminPanel {
      position: fixed;
      top: 0;
      right: -260px;
      width: 260px;
      height: 100%;
      background: rgba(248,250,252,0.96);
      box-shadow: -6px 0 20px rgba(0,0,0,0.4);
      transition: right 0.28s ease;
      padding: 20px 16px;
      z-index: 9999;
      font-size: 0.9rem;
    }

    #adminPanel.open {
      right: 0;
    }

    #adminPanel h3 {
      margin: 12px 0 6px;
      text-align: left;
      font-size: 0.98rem;
    }

    #adminPanel button {
      width: 100%;
      padding: 9px 10px;
      margin: 8px 0;
      font-size: 0.9rem;
      border-radius: 10px;
      border: 1px solid #cbd5e1;
      background: #f8fafc;
      cursor: pointer;
      text-align: left;
    }

    #adminPanel button:active {
      transform: scale(0.97);
      background: #e2e8f0;
    }

    #adminCloseBtn {
      position: absolute;
      top: 10px;
      left: 10px;
      background: #e2e8f0;
      border-radius: 999px;
      width: 28px;
      height: 28px;
      border: 1px solid #cbd5e1;
      font-size: 16px;
      text-align: center;
      line-height: 26px;
      cursor: pointer;
    }

    .admin-caption {
      font-size: 0.78rem;
      color: #64748b;
      margin-bottom: 6px;
    }

    /* Property card */
    .property-bar {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.85rem;
    }

    .property-label {
      white-space: nowrap;
      font-weight: 500;
    }

    .property-select {
      flex: 1;
      padding: 6px 8px;
      font-size: 0.85rem;
      border-radius: 999px;
      border: 1px solid rgba(15,23,42,0.18);
      background: rgba(255,255,255,0.8);
      outline: none;
    }

    .prop-btn {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      border: 1px solid rgba(15,23,42,0.18);
      background: rgba(255,255,255,0.8);
      font-size: 16px;
      padding: 0;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .prop-del {
      background: rgba(248,113,113,0.18);
      border-color: rgba(248,113,113,0.6);
      color: #b91c1c;
    }

    .prop-btn:active {
      transform: scale(0.95);
    }

    /* Month nav */
    .month-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
      margin-bottom: 4px;
    }

    .month-center {
      display: flex;
      gap: 4px;
      align-items: center;
    }

    #monthSelect, #yearInput {
      padding: 4px 6px;
      border-radius: 999px;
      border: 1px solid rgba(15,23,42,0.18);
      background: rgba(255,255,255,0.85);
      font-size: 0.8rem;
      outline: none;
    }

    #yearInput {
      width: 64px;
    }

    .nav-btn {
      border-radius: 999px;
      padding: 3px 8px;
      border: 1px solid rgba(15,23,42,0.15);
      background: rgba(255,255,255,0.8);
      cursor: pointer;
    }

    .nav-btn:active {
      transform: scale(0.95);
    }

    /* View toggle */
    .view-toggle {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .view-btn {
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.75rem;
      border: 1px solid rgba(15,23,42,0.25);
      background: rgba(255,255,255,0.8);
      cursor: pointer;
    }

    .view-btn-active {
      background: #0f766e;
      color: #ecfeff;
      border-color: #0e7490;
    }

    /* Calendar */
    .calendar {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.75rem;
    }

    .calendar thead th {
      padding: 4px 0;
      color: #0f172a;
      font-weight: 600;
    }

    .calendar td {
      height: 44px;
      padding: 0;
      border: 1px solid rgba(15,23,42,0.08);
      background: rgba(255,255,255,0.15);
    }

    .day-btn {
      width: 100%;
      height: 100%;
      border: none;
      background: transparent;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.07s ease, box-shadow 0.08s ease;
    }

    .day-btn:active {
      transform: scale(0.96);
      box-shadow: inset 0 0 0 1px rgba(15,23,42,0.2);
    }

    .day-number {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 2px;
    }

    .booking-badge {
      font-size: 0.6rem;
      padding: 1px 6px;
      border-radius: 999px;
      background: rgba(255,255,255,0.9);
      max-width: 100%;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Year view */
    #yearView {
      margin-top: 4px;
    }

    .year-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 6px;
    }

    .year-month {
      border-radius: 14px;
      border: 1px solid rgba(15,23,42,0.12);
      background: rgba(255,255,255,0.2);
      padding: 4px;
    }

    .year-month-title {
      text-align: center;
      font-size: 0.7rem;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .calendar-mini {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.65rem;
    }

    .calendar-mini th {
      padding: 2px 0;
    }

    .calendar-mini td {
      height: 24px;
      padding: 0;
      border: 1px solid rgba(15,23,42,0.08);
      background: rgba(255,255,255,0.12);
    }

    .calendar-mini .day-btn {
      font-size: 0.65rem;
    }

    /* Legend card */
    .user-legend {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 4px 8px;
      font-size: 0.74rem;
    }

    .user-legend-item {
      display: inline-flex;
      align-items: center;
    }

    .user-legend-swatch {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-right: 4px;
      border: 1px solid #1f2933;
    }

    button {
      font-family: inherit;
    }

    @media (max-width: 360px) {
      .app {
        padding: 8px;
      }
      .card {
        border-radius: 18px;
      }
    }
  </style>
</head>
<body>
<div class="app">
  <!-- HEADER CARD -->
  <div class="card card-compact">
    <div class="card-header">
      <h1>Ash Shack Booking</h1>
      <div class="subtitle">Tap a day to book it.</div>
    </div>
    <div class="top-bar" style="margin-top:6px;">
      <div class="user-label">
        <span>You:</span>
        <span id="userNameLabel" style="font-weight:500;"></span>
        <span id="userColourPreview" class="colour-preview"></span>
      </div>
      <button id="menuBtn">⋯</button>
    </div>
  </div>

  <!-- PROPERTY CARD -->
  <div class="card card-compact">
    <div class="property-bar">
      <span class="property-label">Property:</span>
      <select id="propertySelect" class="property-select"></select>
      <button id="addPropertyBtn" class="prop-btn">+</button>
      <button id="deletePropertyBtn" class="prop-btn prop-del">−</button>
    </div>
  </div>

  <!-- CALENDAR CONTROLS + CALENDAR CARD -->
  <div class="card">
    <div class="month-nav">
      <button id="prevMonthBtn" class="nav-btn">◀</button>
      <div class="month-center">
        <select id="monthSelect"></select>
        <input id="yearInput" type="number">
      </div>
      <button id="nextMonthBtn" class="nav-btn">▶</button>
    </div>

    <div class="view-toggle">
      <button id="viewMonthBtn" class="view-btn view-btn-active">Month</button>
      <button id="viewYearBtn" class="view-btn">Year</button>
    </div>

    <div id="monthView">
      <table class="calendar">
        <thead>
          <tr>
            <th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th>
            <th>Thu</th><th>Fri</th><th>Sat</th>
          </tr>
        </thead>
        <tbody id="calendarBody"></tbody>
      </table>
    </div>

    <div id="yearView" style="display:none;">
      <div class="year-grid" id="yearGrid"></div>
    </div>
  </div>

  <!-- LEGEND CARD -->
  <div class="card card-compact">
    <div id="userLegend" class="user-legend"></div>
  </div>
</div>

<!-- SLIDE-OUT ADMIN PANEL -->
<div id="adminPanel">
  <button id="adminCloseBtn">×</button>
  <h3>User options</h3>
  <div class="admin-caption">These affect only names & colours, not bookings.</div>
  <button id="btnChangeName">Change my name</button>

  <h3 id="adminSectionHeader" style="display:none;">Admin tools</h3>
  <div class="admin-caption" id="adminCaption" style="display:none;">
    For owner/managers only. Requires admin code.
  </div>
  <button id="btnUnlockAdmin">Unlock admin</button>
  <button id="btnRenameUser" style="display:none;">Rename another user (admin)</button>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const ADMIN_CODE = "1746";

firebase.initializeApp({
  apiKey: "AIzaSyDXdfo2XI7xuHs3LOc6q4CbVpMudHfBTCs",
  authDomain: "ash-shack.firebaseapp.com",
  databaseURL: "https://ash-shack-default-rtdb.firebaseio.com",
  projectId: "ash-shack",
  storageBucket: "ash-shack.firebasestorage.app",
  messagingSenderId: "7831464900",
  appId: "1:7831464900:web:18f1c72f0c37f667005291"
});
const db = firebase.database();

/* STATE */
let currentUserName = null;
let currentPropertyId = null;
let bookingsRef = null;
let bookings = {};
let userColours = {};
let currentYear = new Date().getFullYear();
let currentMonth = new Date().getMonth();
let viewMode = "month";

/* DOM */
const userNameLabel = document.getElementById("userNameLabel");
const userColourPreview = document.getElementById("userColourPreview");
const menuBtn = document.getElementById("menuBtn");
const adminPanel = document.getElementById("adminPanel");
const adminCloseBtn = document.getElementById("adminCloseBtn");
const btnChangeName = document.getElementById("btnChangeName");
const btnRenameUser = document.getElementById("btnRenameUser");
const btnUnlockAdmin = document.getElementById("btnUnlockAdmin");
const adminSectionHeader = document.getElementById("adminSectionHeader");
const adminCaption = document.getElementById("adminCaption");

const propertySelect = document.getElementById("propertySelect");
const addPropertyBtn = document.getElementById("addPropertyBtn");
const deletePropertyBtn = document.getElementById("deletePropertyBtn");
const monthSelect = document.getElementById("monthSelect");
const yearInput = document.getElementById("yearInput");
const prevMonthBtn = document.getElementById("prevMonthBtn");
const nextMonthBtn = document.getElementById("nextMonthBtn");
const viewMonthBtn = document.getElementById("viewMonthBtn");
const viewYearBtn = document.getElementById("viewYearBtn");
const monthView = document.getElementById("monthView");
const yearView = document.getElementById("yearView");
const calendarBody = document.getElementById("calendarBody");
const yearGrid = document.getElementById("yearGrid");
const userLegend = document.getElementById("userLegend");

/* HELPERS */
const MONTH_NAMES = [
  "January","February","March","April","May","June",
  "July","August","September","October","November","December"
];

function slugify(t){
  return t.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9\\-]/g,"");
}
function formatDateKey(y,m,d){
  return y + "-" + String(m+1).padStart(2,"0") + "-" + String(d).padStart(2,"0");
}
function colourFromName(name){
  let h = 0;
  for(let i=0;i<name.length;i++) h = name.charCodeAt(i)+((h<<5)-h);
  return "hsl(" + (Math.abs(h)%360) + ",65%,75%)";
}
function ensureUserColour(name){
  const ref = db.ref("users/"+name);
  ref.once("value",snap=>{
    if(!snap.exists()) ref.set({colour:colourFromName(name)});
  });
}

/* USER / PROFILE */
function askForName(){
  let n = "";
  while(!n){
    n = prompt("Enter your name:") || "Guest";
    n = n.trim();
  }
  currentUserName = n;
  localStorage.setItem("hh_user_name", n);
  ensureUserColour(n);
  updateUserUI();
}
function initUser(){
  const stored = localStorage.getItem("hh_user_name");
  if(stored){
    currentUserName = stored;
    ensureUserColour(stored);
  } else {
    askForName();
  }
  updateUserUI();
}
function updateUserUI(){
  userNameLabel.textContent = currentUserName || "";
  const col = userColours[currentUserName]?.colour || colourFromName(currentUserName || "");
  userColourPreview.style.background = col;
}

/* ADMIN PANEL */
menuBtn.onclick = () => {
  adminPanel.classList.add("open");
};
adminCloseBtn.onclick = () => {
  adminPanel.classList.remove("open");
};
btnUnlockAdmin.onclick = () => {
  const code = prompt("Admin code?");
  if(code !== ADMIN_CODE){
    alert("Access denied");
    return;
  }
  btnRenameUser.style.display = "block";
  adminSectionHeader.style.display = "block";
  adminCaption.style.display = "block";
  alert("Admin tools unlocked");
};
btnChangeName.onclick = () => {
  const newName = prompt("Enter new name:");
  if(!newName) return;
  currentUserName = newName.trim();
  localStorage.setItem("hh_user_name", currentUserName);
  ensureUserColour(currentUserName);
  updateUserUI();
  adminPanel.classList.remove("open");
};
btnRenameUser.onclick = async () => {
  const oldName = prompt("Enter CURRENT user name (exact):");
  if(!oldName) return;
  const newName = prompt("Enter NEW user name:");
  if(!newName) return;

  const userRef = db.ref("users/"+oldName);
  const snap = await userRef.once("value");
  if(!snap.exists()){
    alert("User not found");
    return;
  }
  const data = snap.val();
  await db.ref("users/"+newName).set(data);

  const root = db.ref("bookings");
  root.once("value", snapshot=>{
    snapshot.forEach(propSnap=>{
      propSnap.forEach(dateSnap=>{
        const val = dateSnap.val();
        if(val && val.name === oldName){
          dateSnap.ref.update({name:newName});
        }
      });
    });
  });
  await userRef.remove();

  if(currentUserName === oldName){
    currentUserName = newName;
    localStorage.setItem("hh_user_name", newName);
    updateUserUI();
  }
  alert('User renamed from "'+oldName+'" to "'+newName+'".');
  adminPanel.classList.remove("open");
};

/* USERS / LEGEND */
db.ref("users").on("value",snap=>{
  userColours = snap.val() || {};
  updateUserUI();
  renderLegend();
  if(viewMode==="month") renderCalendar();
  else renderYear();
});
function renderLegend(){
  userLegend.innerHTML = "";
  Object.keys(userColours).sort().forEach(n=>{
    const col = userColours[n]?.colour || colourFromName(n);
    const span = document.createElement("span");
    span.className = "user-legend-item";
    span.innerHTML =
      '<span class="user-legend-swatch" style="background:'+col+'"></span>' +
      n;
    userLegend.appendChild(span);
  });
}

/* PROPERTIES */
function loadProperties(){
  db.ref("properties").on("value",snap=>{
    const props = snap.val() || {};
    propertySelect.innerHTML = "";
    const keys = Object.keys(props);
    if(!keys.length){
      const id = "default";
      db.ref("properties/"+id).set({id, name:"Holiday Home"});
      return;
    }
    keys.forEach(id=>{
      const o = document.createElement("option");
      o.value = id;
      o.textContent = props[id].name;
      propertySelect.appendChild(o);
    });
    if(!currentPropertyId || !props[currentPropertyId]) currentPropertyId = keys[0];
    propertySelect.value = currentPropertyId;
    attachBookings();
  });
}
propertySelect.onchange = () => {
  currentPropertyId = propertySelect.value;
  attachBookings();
};
addPropertyBtn.onclick = () => {
  const code = prompt("Admin code?");
  if(code !== ADMIN_CODE){
    alert("Access denied");
    return;
  }
  let n = prompt("New property name:");
  if(!n) return;
  n = n.trim();
  const id = slugify(n) || ("prop-"+Date.now());
  db.ref("properties/"+id).set({id, name:n});
};
deletePropertyBtn.onclick = () => {
  const code = prompt("Admin code?");
  if(code !== ADMIN_CODE){
    alert("Access denied");
    return;
  }
  if(!currentPropertyId) return;
  if(!confirm("Delete this property and all bookings?")) return;
  db.ref("properties/"+currentPropertyId).remove();
  db.ref("bookings/"+currentPropertyId).remove();
};

/* BOOKINGS */
function attachBookings(){
  if(bookingsRef) bookingsRef.off();
  bookingsRef = db.ref("bookings/"+currentPropertyId);
  bookingsRef.on("value",snap=>{
    bookings = snap.val() || {};
    if(viewMode==="month") renderCalendar();
    else renderYear();
  });
}
function toggleBooking(key){
  const existing = bookings[key];
  const ref = db.ref("bookings/"+currentPropertyId+"/"+key);
  if(!existing){
    ref.set({name:currentUserName});
    return;
  }
  if(existing.name === currentUserName){
    if(confirm("Cancel your booking?")) ref.remove();
    return;
  }
  if(confirm(existing.name + " booked this. Replace?")){
    ref.set({name:currentUserName});
  }
}

/* CALENDAR (MONTH) */
function renderCalendar(){
  calendarBody.innerHTML = "";
  const first = new Date(currentYear,currentMonth,1);
  const start = first.getDay();
  const days = new Date(currentYear,currentMonth+1,0).getDate();

  let tr = document.createElement("tr");
  for(let i=0;i<start;i++) tr.appendChild(document.createElement("td"));

  for(let d=1;d<=days;d++){
    if(tr.children.length===7){
      calendarBody.appendChild(tr);
      tr = document.createElement("tr");
    }
    const td = document.createElement("td");
    const btn = document.createElement("button");
    btn.className = "day-btn";

    const num = document.createElement("div");
    num.className = "day-number";
    num.textContent = d;
    btn.appendChild(num);

    const key = formatDateKey(currentYear,currentMonth,d);
    const b = bookings[key];
    if(b){
      const col = userColours[b.name]?.colour || colourFromName(b.name);
      btn.style.background = col;
      const badge = document.createElement("div");
      badge.className = "booking-badge";
      badge.textContent = b.name;
      btn.appendChild(badge);
    }
    btn.onclick = () => toggleBooking(key);
    td.appendChild(btn);
    tr.appendChild(td);
  }
  while(tr.children.length<7) tr.appendChild(document.createElement("td"));
  calendarBody.appendChild(tr);
}

/* YEAR VIEW */
function renderYear(){
  yearGrid.innerHTML = "";
  for(let m=0;m<12;m++){
    const box = document.createElement("div");
    box.className = "year-month";

    const title = document.createElement("div");
    title.className = "year-month-title";
    title.textContent = MONTH_NAMES[m];
    box.appendChild(title);

    const table = document.createElement("table");
    table.className = "calendar-mini";

    const thead = document.createElement("thead");
    const trh = document.createElement("tr");
    ["S","M","T","W","T","F","S"].forEach(t=>{
      const th = document.createElement("th");
      th.textContent = t;
      trh.appendChild(th);
    });
    thead.appendChild(trh);
    table.appendChild(thead);

    const tbody = document.createElement("tbody");
    const first = new Date(currentYear,m,1);
    const start = first.getDay();
    const days = new Date(currentYear,m+1,0).getDate();

    let tr = document.createElement("tr");
    for(let i=0;i<start;i++) tr.appendChild(document.createElement("td"));

    for(let d=1;d<=days;d++){
      if(tr.children.length===7){
        tbody.appendChild(tr);
        tr = document.createElement("tr");
      }
      const td = document.createElement("td");
      const btn = document.createElement("button");
      btn.className = "day-btn";
      btn.textContent = d;

      const key = formatDateKey(currentYear,m,d);
      const b = bookings[key];
      if(b){
        const col = userColours[b.name]?.colour || colourFromName(b.name);
        btn.style.background = col;
      }
      btn.onclick = () => toggleBooking(key);
      td.appendChild(btn);
      tr.appendChild(td);
    }
    while(tr.children.length<7) tr.appendChild(document.createElement("td"));
    tbody.appendChild(tr);
    table.appendChild(tbody);
    box.appendChild(table);
    yearGrid.appendChild(box);
  }
}

/* MONTH/YEAR SELECTOR */
function initMonthSelector(){
  MONTH_NAMES.forEach((n,i)=>{
    const o = document.createElement("option");
    o.value = i;
    o.textContent = n;
    monthSelect.appendChild(o);
  });
  monthSelect.value = currentMonth;
  yearInput.value = currentYear;

  monthSelect.onchange = () => {
    currentMonth = parseInt(monthSelect.value,10);
    renderCalendar();
  };
  yearInput.onchange = () => {
    currentYear = parseInt(yearInput.value,10);
    if(viewMode==="month") renderCalendar();
    else renderYear();
  };
  prevMonthBtn.onclick = () => {
    currentMonth--;
    if(currentMonth<0){ currentMonth=11; currentYear--; }
    monthSelect.value = currentMonth;
    yearInput.value = currentYear;
    if(viewMode==="month") renderCalendar();
    else renderYear();
  };
  nextMonthBtn.onclick = () => {
    currentMonth++;
    if(currentMonth>11){ currentMonth=0; currentYear++; }
    monthSelect.value = currentMonth;
    yearInput.value = currentYear;
    if(viewMode==="month") renderCalendar();
    else renderYear();
  };
  viewMonthBtn.onclick = () => {
    viewMode="month";
    viewMonthBtn.classList.add("view-btn-active");
    viewYearBtn.classList.remove("view-btn-active");
    monthView.style.display="block";
    yearView.style.display="none";
    renderCalendar();
  };
  viewYearBtn.onclick = () => {
    viewMode="year";
    viewYearBtn.classList.add("view-btn-active");
    viewMonthBtn.classList.remove("view-btn-active");
    monthView.style.display="none";
    yearView.style.display="block";
    renderYear();
  };
}

/* INIT */
function init(){
  initUser();
  loadProperties();
  initMonthSelector();
  renderCalendar();

  if("serviceWorker" in navigator){
    window.addEventListener("load",()=>{
      navigator.serviceWorker.register("service-worker.js").catch(()=>{});
    });
  }
}
init();
</script>
</body>
</html>
